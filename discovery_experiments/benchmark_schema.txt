schema {  
  query: Query  
  mutation: Mutation  
  subscription: Subscription  
}

"""Common unique identifier"""  
interface Node { id: ID! }

"""Timestamps for entities"""  
interface Timestamped { createdAt: DateTime! updatedAt: DateTime! }

"""Anything that has a money amount"""  
interface Pricable { currency: Currency! amount: Money! }

"""Entities that can be booked"""  
interface Bookable implements Node & Timestamped {  
  id: ID!  
  createdAt: DateTime!  
  updatedAt: DateTime!  
  title: String!  
  description: String  
  address: Address!  
  photos(first: Int = 20, after: String): PhotoConnection!  
  averageRating: Float  
  reviewCount: Int!  
  policies: [Policy!]!  
  prices(dateRange: DateRangeInput!): [Price!]!  
}

"""Entities that accept reviews"""  
interface Reviewable implements Node & Timestamped {  
  id: ID!  
  createdAt: DateTime!  
  updatedAt: DateTime!  
  averageRating: Float  
  ratingBreakdown: RatingBreakdown  
  reviews(first: Int = 20, after: String): ReviewConnection!  
}

"""Entities that have geo position"""  
interface Locatable { location: Coordinates! }

# ===================== Scalars =====================  
scalar Date  
scalar DateTime  
scalar JSON  
scalar URL

# ===================== Enums (including large ones) =====================

enum Currency { USD EUR GBP JPY CNY KRW AUD CAD CHF SEK NOK DKK HKD SGD INR BRL MXN ZAR AED SAR TRY THB VND }

enum Language { en zh fr de es it ja ko tr ru ar pt nl sv da no fi pl he hi id vi th ms uk cs el hu ro sk bg sr hr lt lv et sl fa ur }

enum BedType { TWIN DOUBLE QUEEN KING CALIFORNIA_KING SOFA_BED BUNK_BED FUTON TATAMI ROLLAWAY MURPHY DAYBED }

enum RoomView { CITY GARDEN OCEAN MOUNTAIN RIVER LAKE COURTYARD POOL STREET SKYLINE DESERT FOREST }

enum PaymentMethod { CREDIT_CARD DEBIT_CARD APPLE_PAY GOOGLE_PAY PAYPAL BANK_TRANSFER CASH GIFT_CARD CRYPTO }

enum LoyaltyTier { BASIC SILVER GOLD PLATINUM DIAMOND BLACK }

"""Oversized enum for stress testing. 50 values."""  
enum AmenityCode {  
  WIFI PARKING POOL SPA GYM SAUNA STEAM_ROOM HOT_TUB BAR RESTAURANT CAFE ROOM_SERVICE CONCIERGE AIRPORT_SHUTTLE PET_FRIENDLY BEACH_ACCESS SKI_IN SKI_OUT KIDS_CLUB PLAYGROUND BUSINESS_CENTER MEETING_ROOMS CONFERENCE_HALL LAUNDRY DRY_CLEANING VALET_PARKING EV_CHARGER BICYCLE_RENTAL CAR_RENTAL ROOFTOP_TERRACE GARDEN LOUNGE LIBRARY GAME_ROOM CINEMA NIGHTCLUB YOGA_STUDIO TENNIS_COURT GOLF_COURSE RUNNING_TRACK BASKETBALL_COURT VOLLEYBALL_COURT SURF_SCHOOL DIVING_CENTER BOAT_RENTAL COOKING_CLASS WINE_TASTING ART_GALLERY GIFT_SHOP MINI_BAR SAFE_BOX  
}

# ===================== Unions =====================

union SearchResult = Hotel | Resort | BoutiqueHotel | Hostel | VacationRental | Experience | Restaurant | Landmark | TransportHub

union Accommodation = Hotel | Resort | BoutiqueHotel | Hostel | VacationRental

union MediaAttachment = Photo | Video | VirtualTour

union PaymentInstrument = CreditCard | PaypalAccount | ApplePayToken | GooglePayToken | BankAccount

union Owner = Person | Organization

union Addressable = Hotel | Restaurant | Experience | TransportHub | Landmark

# ===================== Core Value Types =====================

type Money { value: Float! precision: Int! }

type Coordinates { lat: Float! lon: Float! }

type Address { line1: String! line2: String city: String! region: String postalCode: String! country: String! }

# ===================== Media and Connections =====================

type Photo implements Node & Timestamped {  
  id: ID!  
  createdAt: DateTime!  
  updatedAt: DateTime!  
  url: URL!  
  width: Int  
  height: Int  
  alt: String  
  owner: Owner  
}

type Video implements Node & Timestamped {  
  id: ID!  
  createdAt: DateTime!  
  updatedAt: DateTime!  
  url: URL!  
  durationSec: Int!  
  thumbnail: URL  
}

type VirtualTour implements Node & Timestamped { id: ID! createdAt: DateTime! updatedAt: DateTime! url: URL! provider: String }

# Relay style connections

type PageInfo { hasNextPage: Boolean! hasPreviousPage: Boolean! startCursor: String endCursor: String }

type PhotoEdge { cursor: String! node: Photo! }

type PhotoConnection { edges: [PhotoEdge!]! pageInfo: PageInfo! totalCount: Int! }

type ReviewEdge { cursor: String! node: Review! }

type ReviewConnection { edges: [ReviewEdge!]! pageInfo: PageInfo! totalCount: Int! }

# ===================== Policy and Pricing =====================

type Policy { name: String! description: String active: Boolean! }

type CancellationPolicy { refundableUntilHours: Int! feePercent: Float! notes: String }

type Fee { code: String! description: String amount: Money! currency: Currency! mandatory: Boolean! }

type Tax { name: String! percent: Float! jurisdiction: String }

type Surcharge { name: String! amount: Money! applicableOn: String }

type Price implements Pricable { currency: Currency! amount: Money! label: String breakdown: [Fee!] }

# ===================== Reviews =====================

type RatingBreakdown { overall: Float cleanliness: Float location: Float service: Float value: Float amenities: Float }

type Review implements Node & Timestamped {  
  id: ID!  
  createdAt: DateTime!  
  updatedAt: DateTime!  
  author: User!  
  rating: Float!  
  title: String  
  body: String  
  photos: [Photo!]  
  replies: [ReviewReply!]  
}

type ReviewReply { author: User! body: String createdAt: DateTime! }

# ===================== People and Orgs =====================

type Person implements Node & Timestamped { id: ID! createdAt: DateTime! updatedAt: DateTime! name: String! email: String phone: String }

type Organization implements Node & Timestamped { id: ID! createdAt: DateTime! updatedAt: DateTime! name: String! website: URL }

# ===================== Accommodation Hierarchy =====================

"""Feature matrix with 60 flags to stress clients"""  
input HotelFeaturesInput {  
  WIFI: Boolean  
  PARKING: Boolean  
  POOL: Boolean  
  SPA: Boolean  
  GYM: Boolean  
  SAUNA: Boolean  
  STEAM_ROOM: Boolean  
  HOT_TUB: Boolean  
  BAR: Boolean  
  RESTAURANT: Boolean  
  CAFE: Boolean  
  ROOM_SERVICE: Boolean  
  CONCIERGE: Boolean  
  AIRPORT_SHUTTLE: Boolean  
  PET_FRIENDLY: Boolean  
  BEACH_ACCESS: Boolean  
  SKI_IN: Boolean  
  SKI_OUT: Boolean  
  KIDS_CLUB: Boolean  
  PLAYGROUND: Boolean  
  BUSINESS_CENTER: Boolean  
  MEETING_ROOMS: Boolean  
  CONFERENCE_HALL: Boolean  
  LAUNDRY: Boolean  
  DRY_CLEANING: Boolean  
  VALET_PARKING: Boolean  
  EV_CHARGER: Boolean  
  BICYCLE_RENTAL: Boolean  
  CAR_RENTAL: Boolean  
  ROOFTOP_TERRACE: Boolean  
  GARDEN: Boolean  
  LOUNGE: Boolean  
  LIBRARY: Boolean  
  GAME_ROOM: Boolean  
  CINEMA: Boolean  
  NIGHTCLUB: Boolean  
  YOGA_STUDIO: Boolean  
  TENNIS_COURT: Boolean  
  GOLF_COURSE: Boolean  
  RUNNING_TRACK: Boolean  
  BASKETBALL_COURT: Boolean  
  VOLLEYBALL_COURT: Boolean  
  SURF_SCHOOL: Boolean  
  DIVING_CENTER: Boolean  
  BOAT_RENTAL: Boolean  
  COOKING_CLASS: Boolean  
  WINE_TASTING: Boolean  
  ART_GALLERY: Boolean  
  GIFT_SHOP: Boolean  
  MINI_BAR: Boolean  
  SAFE_BOX: Boolean  
  FIREPLACE: Boolean  
  SOUNDPROOFING: Boolean  
  SMART_TV: Boolean  
  BLACKOUT_CURTAINS: Boolean  
  BIDET: Boolean  
  HEATED_FLOORS: Boolean  
  NON_SMOKING: Boolean  
}

"""Oversized object with 50+ fields"""  
type Hotel implements Node & Timestamped & Bookable & Reviewable & Locatable {  
  id: ID!  
  createdAt: DateTime!  
  updatedAt: DateTime!  
  title: String!  
  description: String  
  address: Address!  
  photos(first: Int = 20, after: String): PhotoConnection!  
  averageRating: Float  
  reviewCount: Int!  
  policies: [Policy!]!  
  prices(dateRange: DateRangeInput!): [Price!]!  
  location: Coordinates!  
  brand: Organization  
  checkInTime: String  
  checkOutTime: String  
  starRating: Int  
  phone: String  
  email: String  
  website: URL  
  amenities: [Amenity!]!  
  features: HotelFeatures!  
  rooms(first: Int = 20, after: String, filter: RoomFilterInput): RoomTypeConnection!  
  restaurants: [Restaurant!]  
  spas: [Spa!]  
  gyms: [Gym!]  
  pools: [Pool!]  
  parking: Parking  
  transport: [TransportHub!]  
  sustainability: SustainabilityScore  
  safety: SafetyProtocol  
  nearbyAttractions(first: Int = 20, after: String): NearbyAttractionConnection!  
  promotions: [Promotion!]  
  events: [Event!]  
  conferenceRooms: [ConferenceRoom!]  
  loyaltyProgram: LoyaltyProgram  
  houseRules: [String!]  
  taxes: [Tax!]  
  surcharges: [Surcharge!]  
  cancellationPolicy: CancellationPolicy  
  paymentMethods: [PaymentMethod!]!  
  languagesSpoken: [Language!]!  
  isBoutique: Boolean!  
  isAdultsOnly: Boolean!  
  isAllInclusive: Boolean!  
  isEcoCertified: Boolean!  
  createdBy: User!  
  lastModifiedBy: User  
  searchScore: Float  
  tags: [String!]  
  inventoryId: ID  
  timezone: String  
  currency: Currency!  
}

type HotelFeatures {  
  WIFI: Boolean!  
  PARKING: Boolean!  
  POOL: Boolean!  
  SPA: Boolean!  
  GYM: Boolean!  
  SAUNA: Boolean!  
  STEAM_ROOM: Boolean!  
  HOT_TUB: Boolean!  
  BAR: Boolean!  
  RESTAURANT: Boolean!  
  CAFE: Boolean!  
  ROOM_SERVICE: Boolean!  
  CONCIERGE: Boolean!  
  AIRPORT_SHUTTLE: Boolean!  
  PET_FRIENDLY: Boolean!  
  BEACH_ACCESS: Boolean!  
  SKI_IN: Boolean!  
  SKI_OUT: Boolean!  
  KIDS_CLUB: Boolean!  
  PLAYGROUND: Boolean!  
  BUSINESS_CENTER: Boolean!  
  MEETING_ROOMS: Boolean!  
  CONFERENCE_HALL: Boolean!  
  LAUNDRY: Boolean!  
  DRY_CLEANING: Boolean!  
  VALET_PARKING: Boolean!  
  EV_CHARGER: Boolean!  
  BICYCLE_RENTAL: Boolean!  
  CAR_RENTAL: Boolean!  
  ROOFTOP_TERRACE: Boolean!  
  GARDEN: Boolean!  
  LOUNGE: Boolean!  
  LIBRARY: Boolean!  
  GAME_ROOM: Boolean!  
  CINEMA: Boolean!  
  NIGHTCLUB: Boolean!  
  YOGA_STUDIO: Boolean!  
  TENNIS_COURT: Boolean!  
  GOLF_COURSE: Boolean!  
  RUNNING_TRACK: Boolean!  
  BASKETBALL_COURT: Boolean!  
  VOLLEYBALL_COURT: Boolean!  
  SURF_SCHOOL: Boolean!  
  DIVING_CENTER: Boolean!  
  BOAT_RENTAL: Boolean!  
  COOKING_CLASS: Boolean!  
  WINE_TASTING: Boolean!  
  ART_GALLERY: Boolean!  
  GIFT_SHOP: Boolean!  
  MINI_BAR: Boolean!  
  SAFE_BOX: Boolean!  
}

# Additional accommodation subtypes

type Resort implements Node & Timestamped & Bookable & Reviewable & Locatable { id: ID! createdAt: DateTime! updatedAt: DateTime! title: String! description: String starRating: Int address: Address! photos(first: Int = 20, after: String): PhotoConnection! averageRating: Float reviewCount: Int! policies: [Policy!]! prices(dateRange: DateRangeInput!): [Price!]! location: Coordinates! allInclusive: Boolean! privateBeach: Boolean }

type BoutiqueHotel implements Node & Timestamped & Bookable & Reviewable & Locatable { id: ID! createdAt: DateTime! updatedAt: DateTime! title: String! description: String address: Address! photos(first: Int = 20, after: String): PhotoConnection! averageRating: Float reviewCount: Int! policies: [Policy!]! prices(dateRange: DateRangeInput!): [Price!]! location: Coordinates! designTheme: String! artCollection: Boolean! }

type Hostel implements Node & Timestamped & Bookable & Reviewable & Locatable { id: ID! createdAt: DateTime! updatedAt: DateTime! title: String! description: String address: Address! photos(first: Int = 20, after: String): PhotoConnection! averageRating: Float reviewCount: Int! policies: [Policy!]! prices(dateRange: DateRangeInput!): [Price!]! location: Coordinates! dormBeds: Int! }

type VacationRental implements Node & Timestamped & Bookable & Reviewable & Locatable { id: ID! createdAt: DateTime! updatedAt: DateTime! title: String! description: String address: Address! photos(first: Int = 20, after: String): PhotoConnection! averageRating: Float reviewCount: Int! policies: [Policy!]! prices(dateRange: DateRangeInput!): [Price!]! location: Coordinates! bedrooms: Int bathrooms: Float hasKitchen: Boolean! host: Owner }

# ===================== Rooms =====================

type RoomType implements Node & Timestamped & Reviewable {  
  id: ID!  
  createdAt: DateTime!  
  updatedAt: DateTime!  
  name: String!  
  description: String  
  sizeSqm: Float  
  maxOccupancy: Int!  
  bedTypes: [BedType!]!  
  view: RoomView  
  amenities: [Amenity!]!  
  photos(first: Int = 20, after: String): PhotoConnection!  
  basePrice: Money!  
  currency: Currency!  
  inventory: Int!  
  policies: [Policy!]  
  cancellationPolicy: CancellationPolicy  
  averageRating: Float  
  ratingBreakdown: RatingBreakdown  
  reviews(first: Int = 20, after: String): ReviewConnection!  
}

type RoomTypeEdge { cursor: String! node: RoomType! }

type RoomTypeConnection { edges: [RoomTypeEdge!]! pageInfo: PageInfo! totalCount: Int! }

# ===================== Amenities =====================

type Amenity { code: AmenityCode! label: String! icon: URL }

# ===================== Facilities and Services =====================

type Restaurant implements Node & Timestamped & Reviewable & Locatable { id: ID! createdAt: DateTime! updatedAt: DateTime! name: String! address: Address! location: Coordinates! cuisines: [Cuisine!]! menu: [MenuItem!]! averageRating: Float ratingBreakdown: RatingBreakdown reviews(first: Int = 20, after: String): ReviewConnection! }

type Cuisine { name: String! regional: String }

type MenuItem { name: String! description: String price: Money! currency: Currency! vegetarian: Boolean vegan: Boolean glutenFree: Boolean }

type Spa implements Node & Timestamped { id: ID! createdAt: DateTime! updatedAt: DateTime! name: String! treatments: [String!]! }

type Gym implements Node & Timestamped { id: ID! createdAt: DateTime! updatedAt: DateTime! name: String! open24h: Boolean! equipment: [String!]! }

type Pool implements Node & Timestamped { id: ID! createdAt: DateTime! updatedAt: DateTime! indoor: Boolean! heated: Boolean! lengthMeters: Float }

type Parking { onSite: Boolean! valet: Boolean! spaces: Int heightLimitMeters: Float evChargers: Int }

type ConferenceRoom implements Node & Timestamped { id: ID! createdAt: DateTime! updatedAt: DateTime! name: String! capacity: Int! areaSqm: Float projector: Boolean! soundSystem: Boolean! }

type Event implements Node & Timestamped & Locatable { id: ID! createdAt: DateTime! updatedAt: DateTime! title: String! description: String startsAt: DateTime! endsAt: DateTime! location: Coordinates! }

# ===================== Transport and Nearby =====================

type TransportHub implements Node & Timestamped & Locatable { id: ID! createdAt: DateTime! updatedAt: DateTime! type: String! name: String! location: Coordinates! distanceKm: Float }

type NearbyAttraction implements Node & Timestamped & Locatable { id: ID! createdAt: DateTime! updatedAt: DateTime! name: String! category: String! location: Coordinates! distanceKm: Float }

type NearbyAttractionEdge { cursor: String! node: NearbyAttraction! }

type NearbyAttractionConnection { edges: [NearbyAttractionEdge!]! pageInfo: PageInfo! totalCount: Int! }

type Landmark implements Node & Timestamped & Locatable { id: ID! createdAt: DateTime! updatedAt: DateTime! name: String! description: String location: Coordinates! }

# ===================== Sustainability and Safety =====================

type SustainabilityScore { energy: Float water: Float waste: Float certification: EnergyCertificate }

type EnergyCertificate { program: String level: String validUntil: Date }

type SafetyProtocol { fireExtinguishers: Boolean smokeDetectors: Boolean emergencyExits: Int defibrillatorOnSite: Boolean }

# ===================== Commerce: Users, Cart, Booking, Payments =====================

type User implements Node & Timestamped { id: ID! createdAt: DateTime! updatedAt: DateTime! name: String! email: String! phone: String loyalty: LoyaltyAccount }

type LoyaltyAccount { program: String tier: LoyaltyTier points: Int memberSince: Date }

type Cart implements Node & Timestamped { id: ID! createdAt: DateTime! updatedAt: DateTime! user: User! items: [CartItem!]! currency: Currency! total: Money! }

type CartItem { sku: ID! title: String! description: String quantity: Int! unitPrice: Money! currency: Currency! }

type Promotion { code: String! description: String discountPercent: Float active: Boolean }

type Coupon { code: String! amountOff: Money currency: Currency percentageOff: Float expiresAt: DateTime }

type GiftCard { code: String! remaining: Money currency: Currency }

type Booking implements Node & Timestamped {  
  id: ID!  
  createdAt: DateTime!  
  updatedAt: DateTime!  
  user: User!  
  item: Accommodation!  
  room: RoomType  
  guests: [Guest!]!  
  dateRange: DateRange!  
  totalPrice: Money!  
  currency: Currency!  
  status: BookingStatus!  
  payments: [Payment!]!  
  invoice: Invoice  
  notes: String  
}

enum BookingStatus { PENDING CONFIRMED CANCELLED CHECKED_IN CHECKED_OUT NO_SHOW REFUNDED }

type Guest { name: String! email: String age: Int }

type Payment implements Node & Timestamped {  
  id: ID!  
  createdAt: DateTime!  
  updatedAt: DateTime!  
  method: PaymentMethod!  
  instrument: PaymentInstrument  
  amount: Money!  
  currency: Currency!  
  status: PaymentStatus!  
}

enum PaymentStatus { AUTHORIZED CAPTURED VOIDED REFUNDED FAILED }

type CreditCard { brand: String last4: String expMonth: Int expYear: Int cardholder: String }

type PaypalAccount { email: String payerId: String }

type ApplePayToken { token: String deviceAccount: String }

type GooglePayToken { token: String }

type BankAccount { bankName: String last4: String iban: String bic: String }

type Refund implements Node & Timestamped { id: ID! createdAt: DateTime! updatedAt: DateTime! payment: Payment! amount: Money! currency: Currency! reason: String }

type Invoice implements Node & Timestamped { id: ID! createdAt: DateTime! updatedAt: DateTime! number: String! issuedTo: User! lineItems: [InvoiceLineItem!]! subtotal: Money! taxes: [Tax!]! total: Money! currency: Currency! pdf: URL }

type InvoiceLineItem { description: String! quantity: Int! unitPrice: Money! }

# ===================== Inputs =====================

input PaginationInput { first: Int after: String last: Int before: String }

input DateRangeInput { start: Date! end: Date! }

input DateRange { start: Date! end: Date! }

input SortInput { field: String! order: SortOrder! }

enum SortOrder { ASC DESC }

input GeoBoundingInput { north: Float south: Float east: Float west: Float }

input PriceFilterInput { min: Float max: Float currency: Currency }

input HotelFilterInput {  
  query: String  
  starsMin: Int  
  location: GeoBoundingInput  
  amenitiesAny: [AmenityCode!]  
  price: PriceFilterInput  
  isEcoCertified: Boolean  
  languagesAny: [Language!]  
}

input RoomFilterInput { capacityAtLeast: Int bedTypesAny: [BedType!] viewsAny: [RoomView!] price: PriceFilterInput }

input ReviewCreateInput { targetId: ID! rating: Float! title: String body: String photos: [URL!] }

input BookingCreateInput {  
  userId: ID!  
  itemId: ID!  
  roomTypeId: ID  
  guests: [GuestInput!]!  
  dateRange: DateRangeInput!  
  payment: PaymentInput!  
  coupon: String  
  notes: String  
}

input GuestInput { name: String! email: String age: Int }

input PaymentInput { method: PaymentMethod! instrument: JSON amount: Float! currency: Currency! }

input HotelCreateInput {  
  title: String!  
  description: String  
  address: AddressInput!  
  location: CoordinatesInput!  
  currency: Currency!  
  features: HotelFeaturesInput  
}

input AddressInput { line1: String! line2: String city: String! region: String postalCode: String! country: String! }

input CoordinatesInput { lat: Float! lon: Float! }

input RestaurantCreateInput { name: String! address: AddressInput! location: CoordinatesInput! cuisines: [String!]! }

input PriceQuoteInput { itemId: ID! dateRange: DateRangeInput! guests: Int }

input SearchInput { query: String filters: HotelFilterInput pagination: PaginationInput sort: SortInput }

# ===================== Query =====================

type Query {  
  node(id: ID!): Node  
  search(input: SearchInput!): [SearchResult!]!  
  hotels(filter: HotelFilterInput, pagination: PaginationInput, sort: SortInput): [Hotel!]!  
  hotel(id: ID!): Hotel  
  roomType(id: ID!): RoomType  
  me: User  
  booking(id: ID!): Booking  
  bookings(userId: ID!, status: BookingStatus): [Booking!]!  
  recommendations(userId: ID!, near: CoordinatesInput, limit: Int = 10): [SearchResult!]!  
}

# ===================== Mutation =====================

type Mutation {  
  createHotel(input: HotelCreateInput!): Hotel!  
  createRestaurant(input: RestaurantCreateInput!): Restaurant!  
  createReview(input: ReviewCreateInput!): Review!  
  createBooking(input: BookingCreateInput!): Booking!  
  cancelBooking(id: ID!, reason: String): Booking!  
  capturePayment(paymentId: ID!): Payment!  
  refundPayment(paymentId: ID!, amount: Float!): Refund!  
  applyCoupon(bookingId: ID!, code: String!): Booking!  
}

# ===================== Subscription =====================

type Subscription {  
  bookingStatus(bookingId: ID!): BookingStatus!  
  priceChanged(itemId: ID!): Price!  
}
